<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Aloca√ß√£o Estrat√©gica - UNINOVE</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --blue: #1d366d; --red: #e31d1a; --bg: #f4f7fa; --card: #ffffff; --text: #334155; }
        * { box-sizing: border-box; font-family: 'Poppins', sans-serif; transition: 0.2s ease; }
        body { background: var(--bg); margin: 0; padding: 20px; color: var(--text); display: flex; flex-direction: column; min-height: 100vh; }
        
        .container { max-width: 900px; margin: 0 auto; background: var(--card); border-radius: 20px; padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); width: 100%; }
        .logo-container { text-align: center; margin-bottom: 25px; }
        .logo-container img { max-width: 200px; }
        h1 { color: var(--blue); text-align: center; font-size: 1.8rem; margin-top: 0; }
        
        .intro { background: #f8fafc; border-left: 5px solid var(--red); padding: 20px; border-radius: 12px; margin-bottom: 30px; font-size: 0.95rem; color: #475569; }
        
        .form-group { margin-bottom: 30px; }
        label { display: block; font-weight: 600; margin-bottom: 10px; color: var(--blue); font-size: 1.05rem; }
        input[type="text"], select, textarea { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 1rem; outline: none; }
        input:focus, select:focus, textarea:focus { border-color: var(--blue); }
        
        .range-labels { display: flex; justify-content: space-between; font-size: 0.8rem; color: #94a3b8; margin-top: 5px; font-weight: 500;}
        input[type="range"] { width: 100%; cursor: pointer; }

        .option-card { 
            background: #fff; border: 2px solid #f1f5f9; padding: 16px; margin: 10px 0; 
            border-radius: 12px; cursor: pointer; border-left: 4px solid #cbd5e1; font-size: 0.95rem;
        }
        .option-card:hover { border-color: #93c5fd; transform: translateX(5px); background: #f8fafc; }
        .option-card.selected { background: var(--blue); color: white; border-color: var(--blue); border-left-color: var(--red); }

        .btn-primary { 
            background: var(--blue); color: white; border: none; padding: 18px; 
            border-radius: 12px; cursor: pointer; font-weight: 600; width: 100%; font-size: 1.1rem; margin-top: 10px;
        }
        .btn-primary:hover { background: #162a55; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(29,54,109,0.2); }

        .admin-section { margin-top: 30px; }
        .table-wrapper { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 12px; }
        table { width: 100%; border-collapse: collapse; text-align: left; }
        th { background: #f8fafc; padding: 16px; color: var(--blue); font-size: 0.9rem; border-bottom: 2px solid #e2e8f0; }
        td { padding: 16px; border-bottom: 1px solid #f1f5f9; cursor: pointer; font-size: 0.95rem; }
        tr:hover td { background: #f8fafc; }

        .modal { display: none; position: fixed; z-index: 1000; left:0; top:0; width:100%; height:100%; background: rgba(15,23,42,0.8); backdrop-filter: blur(4px); }
        .modal-content { background: white; margin: 2% auto; padding: 40px; width: 95%; max-width: 800px; border-radius: 20px; max-height: 90vh; overflow-y: auto; position: relative; }
        .close-modal { position: absolute; right: 25px; top: 25px; font-size: 30px; cursor: pointer; color: #94a3b8; line-height: 1; text-decoration: none;}
        .close-modal:hover { color: var(--red); }
        
        .rank-item { margin-bottom: 15px; }
        .rank-bar-bg { background: #f1f5f9; height: 12px; border-radius: 6px; margin-top: 6px; overflow: hidden; }
        .rank-bar-fill { height: 100%; background: var(--blue); border-radius: 6px; }
        
        .answer-box { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 10px; padding: 15px; margin-bottom: 12px; }
        .answer-box h4 { margin: 0 0 8px 0; color: var(--blue); font-size: 0.9rem; }
        .answer-box p { margin: 0; font-size: 0.95rem; font-weight: 500; color: var(--text); }
        
        .badge { background: var(--blue); color: white; padding: 5px 12px; border-radius: 8px; font-size: 0.8rem; font-weight: 600; }
        .hidden { display: none; }
        .step { animation: fadeIn 0.4s ease-out; }

        footer { margin-top: auto; padding-top: 40px; text-align: center; font-size: 0.9rem; color: #64748b; }
        .credits-link { color: var(--blue); text-decoration: none; font-weight: 600; cursor: pointer; }
        .credits-link:hover { text-decoration: underline; color: var(--red); }
        
        .btn-whatsapp {
            display: inline-block; background: #25D366; color: white; padding: 14px 28px; 
            border-radius: 12px; text-decoration: none; font-weight: 600; font-size: 1.05rem;
            margin-top: 25px; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
        }
        .btn-whatsapp:hover { background: #1ebc5a; transform: translateY(-2px); color: white; }

        #game-trigger {
            position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px;
            background: var(--red); color: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 32px; cursor: pointer; box-shadow: 0 4px 15px rgba(227, 29, 26, 0.4);
            z-index: 999; transition: transform 0.3s;
        }
        #game-trigger:hover { transform: scale(1.1) rotate(10deg); }

        #gameCanvas {
            background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; 
            max-width: 100%; display: block; margin: 0 auto; touch-action: none; cursor: crosshair;
        }

        .header-admin {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;
        }

        .btn-group {
            display: flex; gap: 10px; flex-wrap: wrap;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <div class="logo-container"><img src="logo_uninove.png" alt="UNINOVE"></div>

    <div id="quiz-flow">
        <div id="step-1" class="step">
            <h1>Descubra sua Fun√ß√£o na Equipe</h1>
            <div class="intro">
                Fique tranquilo(a)! Este teste tem perguntas sobre coisas do seu dia a dia. A ideia √© descobrir o seu perfil natural (como voc√™ organiza as coisas, resolve problemas ou trabalha em grupo) para acharmos a √°rea da tecnologia que mais combina com voc√™!
            </div>
            <div class="form-group">
                <label>Seu Nome Completo *</label>
                <input type="text" id="nome" placeholder="Digite seu nome" required>
            </div>
            <div class="form-group">
                <label>Seu Telefone / WhatsApp *</label>
                <input type="text" id="telefone" placeholder="(11) 99999-9999" maxlength="15" required>
            </div>
            <div class="form-group">
                <label>Que horas voc√™ consegue chegar na aula de Quinta-feira? *</label>
                <input type="text" id="horario_quinta" placeholder="Ex: 19:00 ou Depende do tr√¢nsito..." required>
            </div>
            <div class="form-group">
                <label>Um breve resumo sobre voc√™:</label>
                <textarea id="desc" rows="2" placeholder="O que voc√™ gosta de fazer? Quais seus hobbies?"></textarea>
            </div>
            <button class="btn-primary" onclick="next(2)">Avan√ßar</button>
        </div>

        <div id="step-2" class="step hidden">
            <div class="form-group">
                <label>Seu n√≠vel geral de uso de Computadores (0 a 10)</label>
                <input type="range" id="lvl-info" min="0" max="10" value="5">
                <div class="range-labels"><span>B√°sico</span><span>Intermedi√°rio</span><span>Avan√ßado</span></div>
            </div>
            <div class="form-group">
                <label>Seu n√≠vel atual em Programa√ß√£o (0 a 10)</label>
                <input type="range" id="lvl-prog" min="0" max="10" value="0">
                <div class="range-labels"><span>Nunca vi</span><span>Estou aprendendo</span><span>J√° programo</span></div>
            </div>
            <div class="form-group">
                <label>Seu n√≠vel em Banco de Dados (0 a 10)</label>
                <input type="range" id="lvl-db" min="0" max="10" value="0">
                <div class="range-labels"><span>N√£o sei o que √©</span><span>Conhe√ßo tabelas</span><span>Domino</span></div>
            </div>
            <div class="form-group">
                <label>Quantas horas por semana voc√™ pode dedicar ao projeto fora da aula?</label>
                <select id="horas">
                    <option value="1">0 a 1 hora (Tempo muito corrido)</option>
                    <option value="3">2 a 4 horas (Um pouco de tempo)</option>
                    <option value="6" selected>5 a 7 horas (Tempo razo√°vel)</option>
                    <option value="9">8 a 10 horas (Bastante tempo)</option>
                    <option value="15">Mais de 11 horas (Disponibilidade total)</option>
                </select>
            </div>
            <button class="btn-primary" onclick="next(3)">Ir para o Question√°rio</button>
        </div>

        <div id="step-3" class="step hidden">
            <div id="questions-area"></div>
            <button class="btn-primary" id="btn-envio" onclick="enviarTudo()">Finalizar e Enviar Respostas</button>
        </div>

        <div id="step-success" class="step hidden" style="text-align:center; padding: 40px 0;">
            <h1 style="color:var(--red); font-size: 2.5rem; margin-bottom: 10px;">Feito! üéâ</h1>
            <p style="font-size: 1.1rem; color: #475569;">Suas respostas foram salvas no sistema da equipe.</p>
            <p>Com base nisso, vamos montar um grupo incr√≠vel onde cada um faz o que tem mais facilidade!</p>
        </div>
    </div>
</div>

<div class="admin-section container" style="background:transparent; box-shadow:none; padding:0; margin-top: 10px;">
    <button onclick="openAdmin()" style="border:none; color:#94a3b8; cursor:pointer; font-size: 0.85rem; background:none; text-decoration: underline;">Acessar √Årea Administrativa</button>
    <div id="admin-panel" class="hidden" style="background:white; padding:30px; border-radius:20px; margin-top:20px; border: 1px solid #e2e8f0;">
        <div class="header-admin">
            <div>
                <h2 style="color:var(--blue); margin-top:0; margin-bottom: 5px;">Resultados da Equipe</h2>
                <p style="font-size:0.9rem; color:#64748b; margin: 0;">Clique na linha do aluno para ver detalhes.</p>
            </div>
            <div class="btn-group">
                <button class="btn-primary" onclick="exportarHTML()" style="margin:0; width:auto; padding:12px 20px; font-size:0.95rem;">üìÑ Baixar HTML</button>
                <button class="btn-primary" onclick="imprimirPDF()" style="margin:0; width:auto; padding:12px 20px; font-size:0.95rem; background: var(--red);">üñ®Ô∏è Salvar em PDF</button>
            </div>
        </div>
        <div class="table-wrapper">
            <table id="admin-table">
                <thead>
                    <tr><th>Aluno</th><th>Melhor Afinidade</th><th>Tempo Dispon√≠vel</th></tr>
                </thead>
                <tbody id="table-body"></tbody>
            </table>
        </div>
    </div>
</div>

<footer>
    Cr√©ditos: <a class="credits-link" onclick="openCredits()">Guilherme Ferreira Bento (clique aqui para me conhecer)</a>
</footer>

<div id="game-trigger" onclick="openGame()" title="Jornada do Dev">üéÆ</div>

<div id="gameModal" class="modal">
    <div class="modal-content" style="max-width: 550px; text-align: center;">
        <span class="close-modal" onclick="closeGame()">&times;</span>
        <h2 style="color:var(--blue); font-size: 2rem; margin-top: 0;">Jornada do Diploma üöÄ</h2>
        <p style="font-size: 0.95rem; color: #64748b; margin-bottom: 20px;">Mova o mouse ou toque na tela para guiar o Dev. <br> Pegue Caf√© ‚òï e Ideias üí°. Desvie dos Bugs üêõ!</p>
        
        <canvas id="gameCanvas" width="450" height="300"></canvas>
        
        <div style="background:#e2e8f0; height:20px; border-radius:10px; margin:20px 0; overflow:hidden;">
            <div id="game-progress" style="width:0%; height:100%; background:var(--red); transition:width 0.3s ease-out;"></div>
        </div>
        <p><b id="game-status" style="font-size: 1.1rem; color: var(--blue);">Pronto para come√ßar?</b></p>
        <button class="btn-primary" id="btn-start-game" onclick="startGame()" style="font-size: 1.1rem; padding: 15px;">Iniciar Jornada üíª</button>
    </div>
</div>

<div id="creditsModal" class="modal">
    <div class="modal-content" style="max-width: 650px; text-align: center; padding: 50px 30px;">
        <span class="close-modal" onclick="closeCredits()">&times;</span>
        <h2 style="color: var(--blue); margin-top: 0; font-size: 2rem;">Prazer üëã</h2>
        
        <div style="text-align: justify; color: var(--text); font-size: 1rem; line-height: 1.7; margin-top: 25px;">
            <p>Ol√°, tudo bem? Sou o Guilherme Bento, estamos na mesma turma e no mesmo barco, hehe. Muito prazer em te conhecer! Tenho 22 anos e curto bastante videogames. Se quiser me adicionar, minha ID do PlayStation, gamertag do Xbox e ID da Steam √© <b>Smilerapz</b>. Tamb√©m sou f√£ de animes, s√©ries, filmes, m√∫sica, futebol e v√°rias outras coisas que rendem boas conversas. E claro, namoro a menina mais incr√≠vel do mundo ‚ù§Ô∏è.</p>
            
            <p>Sou graduado em <b>Tecnologia em Marketing Digital</b>, especialista em <b>Gest√£o da Tecnologia da Informa√ß√£o</b> e em <b>Ci√™ncia de Dados e Intelig√™ncia Artificial</b>. J√° atuo faz pouco tempo na √°rea e hoje trabalho como <b>Analista de Sistemas Jr.</b> em uma faculdade no centro de S√£o Paulo.</p>
            
            <p>Meu objetivo aqui na Uninove √© buscar a base te√≥rica e pr√°tica que n√£o tive no in√≠cio da minha jornada tech. Voltei justamente para construir esse solo firme e, claro, aproveitar para fazer networking, trocar ideias sempre agrega muito. Ent√£o, se quiser bater um papo, √© s√≥ me chamar.</p>
        </div>

        <a href="https://wa.me/5517996358942?text=Oi,%20Guilherme.%20Tudo%20bem?%20Sou%20da%20UNINOVE" target="_blank" class="btn-whatsapp">
            üì± Chamar no WhatsApp
        </a>
    </div>
</div>

<div id="detailModal" class="modal">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <h2 id="m-nome" style="color:var(--blue); font-size: 1.8rem; margin:0 0 5px 0;">Nome</h2>
        <p id="m-desc" style="color:#64748b; font-style: italic; margin-top:0; margin-bottom: 10px;"></p>
        <p id="m-telefone" style="color:var(--blue); font-weight: 600; margin-top:0; margin-bottom: 5px;"></p>
        <p id="m-horario" style="color:var(--blue); font-weight: 600; margin-top:0; margin-bottom: 20px;"></p>
        
        <div style="display: flex; gap: 15px; margin-bottom: 30px;">
            <span class="badge" id="m-info"></span>
            <span class="badge" id="m-prog"></span>
            <span class="badge" id="m-db"></span>
        </div>

        <h3 style="border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; color: var(--blue);">An√°lise de Afinidade</h3>
        <div id="m-stats" style="margin-bottom: 40px;"></div>

        <h3 style="border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; color: var(--blue);">Hist√≥rico de Respostas</h3>
        <div id="m-answers"></div>
    </div>
</div>

<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyVi-ryWwuSbPsuOj1kcq77degvkJsOV4qTrpqLC8GJY0PmcZYIrCD6hOkAzJazWw-i5A/exec';

    document.getElementById('telefone').addEventListener('input', function (e) {
        let x = e.target.value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,5})(\d{0,4})/);
        e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
    });

    const perguntas = [
        {
            q: "1. Se voc√™ fosse ajudar a organizar uma festa de anivers√°rio, o que preferiria fazer?",
            options: [
                { t: "Fazer os c√°lculos de quanto vai custar e dividir as despesas.", p: [8, 0, 10, 0, 0, 0] },
                { t: "Cuidar da decora√ß√£o, das cores e de deixar o ambiente bonito.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Fazer a lista de convidados e organizar quem traz o qu√™.", p: [0, 0, 0, 10, 2, 0] },
                { t: "Criar o convite com os textos e explicar como chegar ao local.", p: [0, 0, 0, 0, 10, 4] },
                { t: "Coordenar tudo para garantir que a festa comece na hora certa.", p: [0, 0, 0, 0, 2, 10] }
            ]
        },
        {
            q: "2. Quando voc√™ vai montar um m√≥vel novo (tipo um guarda-roupa):",
            options: [
                { t: "Olho as dobradi√ßas, os encaixes e tento entender a l√≥gica por tr√°s.", p: [8, 0, 10, 0, 0, 0] },
                { t: "J√° fico imaginando como ele vai combinar com a parede e os enfeites.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Antes de tudo, separo todos os parafusos por tamanho e tipo.", p: [2, 0, 0, 10, 0, 0] },
                { t: "Pego o manual, leio passo a passo e vou guiando quem est√° montando.", p: [0, 0, 0, 0, 10, 4] },
                { t: "Organizo quem vai segurar a porta e quem vai parafusar para ir mais r√°pido.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "3. Em um trabalho em grupo da escola/faculdade, voc√™ geralmente assume a parte de:",
            options: [
                { t: "Fazer as pesquisas dif√≠ceis e resolver os c√°lculos complicados.", p: [10, 0, 8, 0, 0, 0] },
                { t: "Montar os slides do PowerPoint, escolhendo imagens e fontes legais.", p: [0, 10, 0, 0, 2, 0] },
                { t: "Juntar as partes de todo mundo e padronizar o documento no Word.", p: [0, 0, 0, 10, 4, 0] },
                { t: "Escrever a introdu√ß√£o, revisar os textos e apresentar l√° na frente.", p: [0, 0, 0, 0, 10, 6] },
                { t: "Cobrar a parte de cada um para ningu√©m entregar atrasado.", p: [0, 0, 0, 0, 2, 10] }
            ]
        },
        {
            q: "4. Quando voc√™ cozinha uma receita nova e complexa:",
            options: [
                { t: "Sigo as medidas exatas e a temperatura como se fosse uma f√≥rmula.", p: [6, 0, 10, 0, 0, 0] },
                { t: "Me preocupo muito com a apresenta√ß√£o e beleza do prato no final.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Pico e separo todos os ingredientes em potinhos antes de ligar o fogo.", p: [0, 0, 0, 10, 0, 0] },
                { t: "Gosto de anotar o passo a passo no meu caderno para n√£o esquecer.", p: [0, 0, 0, 2, 10, 0] },
                { t: "Fico supervisionando a cozinha enquanto pe√ßo ajuda aos outros.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "5. Na hora de jogar um jogo de tabuleiro ou videogame novo:",
            options: [
                { t: "Tento achar falhas nas regras ou criar estrat√©gias super l√≥gicas para vencer.", p: [8, 0, 10, 0, 0, 0] },
                { t: "Fico admirando os gr√°ficos, os personagens e o mapa do jogo.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Gosto de gerenciar o invent√°rio, os recursos e os itens coletados.", p: [2, 0, 0, 10, 0, 0] },
                { t: "Leio a hist√≥ria do jogo, as miss√µes e gosto de explicar para os amigos.", p: [0, 0, 0, 0, 10, 3] },
                { t: "Crio um cl√£/grupo e decido para onde a equipe vai na partida.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "6. Se voc√™ fosse o diretor de um filme de fic√ß√£o/detetive, no que focaria mais?",
            options: [
                { t: "No mist√©rio cient√≠fico e em como a m√°quina do tempo funciona de verdade.", p: [10, 0, 8, 0, 0, 0] },
                { t: "Na fotografia, efeitos especiais e nos figurinos impec√°veis.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Em organizar a linha do tempo e as pistas para n√£o ter furos na hist√≥ria.", p: [0, 0, 0, 10, 2, 0] },
                { t: "No roteiro bem escrito e nos di√°logos perfeitos dos personagens.", p: [0, 0, 0, 0, 10, 2] },
                { t: "Em liderar os atores e a equipe t√©cnica para tudo fluir bem no set.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "7. Quando algo d√° errado e quebra na sua casa (ex: uma TV ou encanamento):",
            options: [
                { t: "Abro para tentar achar o problema mec√¢nico/el√©trico e consertar sozinho.", p: [10, 0, 10, 0, 0, 0] },
                { t: "Me incomodo se o conserto deixar o local feio ou com remendos vis√≠veis.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Verifico onde est√° a caixa de ferramentas e a planta da casa primeiro.", p: [0, 0, 0, 10, 0, 0] },
                { t: "Pesquiso na internet ou leio manuais sobre como outras pessoas resolveram.", p: [0, 0, 0, 0, 10, 0] },
                { t: "Ligo r√°pido para um profissional e gerencio a visita dele.", p: [0, 0, 0, 0, 2, 10] }
            ]
        },
        {
            q: "8. Seu quarto ou ambiente de estudo costuma ser:",
            options: [
                { t: "Pr√°tico. S√≥ tem o necess√°rio para eu agir r√°pido, sem firulas.", p: [8, 0, 8, 0, 0, 0] },
                { t: "Personalizado e bonito, com posters, luzes ou coisas que combinam.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Categorizado. Gavetas separadas, livros por tamanho ou assunto.", p: [0, 0, 0, 10, 0, 0] },
                { t: "Cheio de post-its, cadernos de anota√ß√µes e quadros de avisos.", p: [0, 0, 0, 2, 10, 0] },
                { t: "√â o local onde meus amigos/irm√£os se re√∫nem e eu doto as regras.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "9. Se voc√™ fosse escrever um livro, que tipo seria?",
            options: [
                { t: "Um manual t√©cnico ou um livro de quebra-cabe√ßas l√≥gicos.", p: [8, 0, 10, 0, 0, 0] },
                { t: "Um livro de arte, design ou uma revista em quadrinhos lind√≠ssima.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Uma enciclop√©dia catalogando centenas de fatos e dados hist√≥ricos.", p: [0, 0, 0, 10, 0, 0] },
                { t: "Um guia de sobreviv√™ncia com explica√ß√µes claras para ajudar os outros.", p: [0, 0, 0, 0, 10, 3] },
                { t: "Um livro de autoajuda sobre como liderar pessoas e ter sucesso.", p: [0, 0, 0, 0, 0, 10] }
            ]
        },
        {
            q: "10. Como seus amigos costumam descrever voc√™?",
            options: [
                { t: "Racional, l√≥gico e bom em resolver pepinos dif√≠ceis.", p: [10, 0, 10, 0, 0, 0] },
                { t: "Criativo, com bom gosto e que repara nos detalhes visuais.", p: [0, 10, 0, 0, 0, 0] },
                { t: "Met√≥dico, organizado e que nunca perde as coisas.", p: [0, 0, 0, 10, 0, 0] },
                { t: "Conselheiro, fala bem e sabe explicar as coisas com clareza.", p: [0, 0, 0, 0, 10, 5] },
                { t: "O l√≠der natural que toma a frente e decide os rol√™s.", p: [0, 0, 0, 0, 0, 10] }
            ]
        }
    ];

    let userChoices = [];
    let globalData = [];

    const qArea = document.getElementById('questions-area');
    perguntas.forEach((perg, i) => {
        let html = `<div class="form-group"><label>${perg.q}</label>`;
        perg.options.forEach((opt, j) => {
            html += `<div class="option-card" onclick="selectOpt(${i}, ${j}, this)" data-q="${i}">${opt.t}</div>`;
        });
        qArea.innerHTML += html + `</div>`;
    });

    function selectOpt(qIdx, optIdx, el) {
        document.querySelectorAll(`[data-q="${qIdx}"]`).forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        userChoices[qIdx] = optIdx;
    }

    function next(s) {
        if(s === 2) {
            if(!document.getElementById('nome').value) return alert("Por favor, informe seu nome.");
            if(!document.getElementById('telefone').value || document.getElementById('telefone').value.length < 14) return alert("Por favor, informe um telefone v√°lido.");
            if(!document.getElementById('horario_quinta').value) return alert("Por favor, informe o hor√°rio de chegada na quinta-feira.");
        }
        document.querySelectorAll('.step').forEach(d => d.classList.add('hidden'));
        document.getElementById(`step-${s}`).classList.remove('hidden');
        window.scrollTo(0, 0);
    }

    async function enviarTudo() {
        if(userChoices.filter(x => x !== undefined).length < 10) return alert("Por favor, responda todas as 10 perguntas!");
        const btn = document.getElementById('btn-envio');
        btn.disabled = true; btn.innerText = "Calculando seu perfil...";

        const payload = {
            nome: document.getElementById('nome').value,
            desc: document.getElementById('telefone').value + "|||" + document.getElementById('horario_quinta').value + "|||" + document.getElementById('desc').value,
            info: document.getElementById('lvl-info').value,
            prog: document.getElementById('lvl-prog').value,
            db: document.getElementById('lvl-db').value,
            horas: document.getElementById('horas').value,
            detalhes: JSON.stringify(userChoices)
        };

        try {
            await fetch(SCRIPT_URL, { method: 'POST', body: JSON.stringify(payload) });
            next('success');
        } catch(e) { alert("Erro ao enviar dados. Tente novamente."); btn.disabled = false; }
    }

    function openAdmin() {
        if(prompt("Digite a senha de acesso:") === 'UWNJ6v3CLwCg26E3TWP4') {
            document.getElementById('admin-panel').classList.remove('hidden');
            loadTable();
        }
    }

    async function loadTable() {
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = "<tr><td colspan='3'>Carregando dados...</td></tr>";
        
        const res = await fetch(SCRIPT_URL);
        globalData = await res.json();
        tbody.innerHTML = "";
        
        globalData.forEach((row, i) => {
            const analysis = calculateScores(row);
            const tr = document.createElement('tr');
            tr.onclick = () => showDetails(i, analysis);
            tr.innerHTML = `
                <td><b>${row[1]}</b></td>
                <td><span class="badge" style="background:var(--red)">${analysis.main}</span></td>
                <td>${row[6]} hrs/semana</td>
            `;
            tbody.appendChild(tr);
        });
    }

    function calculateScores(row) {
        let scores = { "Dev Back-end": 0, "Dev Front-end": 0, "Dev C": 0, "DBA / Dados": 0, "Analista Requisitos": 0, "L√≠der": 0 };
        const keys = Object.keys(scores);
        const choices = JSON.parse(row[8] || "[]");
        const progLvl = parseInt(row[4] || "0");
        const dbLvl = parseInt(row[5] || "0");
        const hrs = parseInt(row[6] || "0");

        choices.forEach((optIdx, qIdx) => {
            if(optIdx === null || optIdx === undefined || !perguntas[qIdx]) return;
            const weights = perguntas[qIdx].options[optIdx].p;
            for(let k=0; k<6; k++) scores[keys[k]] += weights[k];
        });

        if(progLvl >= 7) { scores["Dev Back-end"] += 15; scores["Dev C"] += 15; }
        if(dbLvl >= 7) { scores["DBA / Dados"] += 20; }
        
        if(progLvl < 4 && hrs >= 9) {
            scores["Dev Back-end"] += 10; scores["Dev C"] += 10;
        } else if (progLvl < 4 && hrs <= 4) {
            scores["Analista Requisitos"] += 15; scores["Dev Front-end"] += 10;
        }

        const entries = Object.entries(scores).filter(e => e[0] !== 'L√≠der');
        
        const mainMatch = entries.reduce((a, b) => {
            if (a[1] === b[1]) {
                if (a[0] === 'Dev Back-end') { b[1] -= 1; return a; }
                if (b[0] === 'Dev Back-end') { a[1] -= 1; return b; }
            }
            return a[1] > b[1] ? a : b;
        });

        return { scores, main: mainMatch[0] };
    }

    function showDetails(idx, analysis) {
        const row = globalData[idx];
        const choices = JSON.parse(row[8] || "[]");
        
        let rawDesc = row[2] ? row[2].toString() : "";
        let partes = rawDesc.split("|||");
        let tel = "";
        let hor = "";
        let descReal = rawDesc;

        if (partes.length >= 3) {
            tel = partes[0];
            hor = partes[1];
            descReal = partes.slice(2).join("|||");
        } else if (partes.length === 2) {
            tel = partes[0];
            descReal = partes[1];
        }

        document.getElementById('m-nome').innerText = row[1];
        document.getElementById('m-desc').innerText = descReal ? `"${descReal}"` : "";
        document.getElementById('m-telefone').innerText = tel ? `üì± Telefone: ${tel}` : "";
        document.getElementById('m-horario').innerText = hor ? `üïí Chega quinta √†s: ${hor}` : "";
        document.getElementById('m-info').innerText = `Info: ${row[3]}/10`;
        document.getElementById('m-prog').innerText = `Prog: ${row[4]}/10`;
        document.getElementById('m-db').innerText = `Banco: ${row[5]}/10`;

        const sorted = Object.entries(analysis.scores).sort((a,b) => b[1] - a[1]);
        const maxScore = sorted[0][1] || 1; 

        let statsHtml = '';
        sorted.forEach(([area, val]) => {
            let perc = Math.min(100, Math.round((val / maxScore) * 100));
            let color = area === 'L√≠der' ? '#94a3b8' : 'var(--blue)'; 
            statsHtml += `
                <div class="rank-item">
                    <div style="display:flex; justify-content:space-between; font-size:0.85rem; font-weight:600;">
                        <span>${area}</span><span style="color:${color}">${perc}%</span>
                    </div>
                    <div class="rank-bar-bg"><div class="rank-bar-fill" style="width:${perc}%; background:${color}"></div></div>
                </div>`;
        });
        document.getElementById('m-stats').innerHTML = statsHtml;

        let answersHtml = '';
        perguntas.forEach((perg, i) => {
            const userAnsIdx = choices[i];
            const answerText = (userAnsIdx !== null && userAnsIdx !== undefined && perg.options[userAnsIdx]) ? perg.options[userAnsIdx].t : "N√£o respondeu";
            
            answersHtml += `
                <div class="answer-box">
                    <h4>${perg.q}</h4>
                    <p>R: ${answerText}</p>
                </div>
            `;
        });
        document.getElementById('m-answers').innerHTML = answersHtml;

        document.getElementById('detailModal').style.display = 'block';
    }

    function exportarHTML() {
        if (!globalData || globalData.length === 0) return alert("Nenhum dado para exportar!");

        const sortedData = [...globalData].sort((a, b) => a[1].localeCompare(b[1]));

        let htmlContent = `
        <!DOCTYPE html>
        <html lang="pt-br">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Relat√≥rio - Equipe UNINOVE</title>
            <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
            <style>
                * { box-sizing: border-box; }
                body { background-color: #f4f7fa; font-family: 'Poppins', sans-serif; padding: 40px 20px; color: #334155; margin: 0; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                .report-card { background: #fff; max-width: 800px; margin: 0 auto 40px auto; padding: 50px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); page-break-after: always; }
                .report-header { text-align: center; color: #94a3b8; font-size: 12px; font-weight: bold; letter-spacing: 2px; margin-bottom: 30px; text-transform: uppercase; }
                .report-name { color: #1d366d; border-bottom: 2px solid #e2e8f0; padding-bottom: 15px; margin-bottom: 15px; text-align: center; font-size: 28px; }
                .report-role { color: #e31d1a; text-align: center; margin-bottom: 35px; font-size: 20px; font-weight: 600; }
                .info-box { background: #f8fafc; padding: 25px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 30px; font-size: 15px; line-height: 1.6; }
                .info-box p { margin: 8px 0; }
                .skills-container { display: flex; justify-content: center; gap: 15px; margin-bottom: 40px; flex-wrap: wrap; }
                .skill-badge { background: #1d366d; color: white; padding: 10px 20px; border-radius: 10px; font-size: 15px; font-weight: bold; }
                .stats-title { color: #1d366d; margin-bottom: 20px; font-size: 18px; font-weight: 700; }
                .stat-item { margin-bottom: 15px; }
                .stat-label { display: flex; justify-content: space-between; font-weight: 600; font-size: 14px; margin-bottom: 6px; }
                .stat-bar-bg { background: #e2e8f0; height: 14px; border-radius: 7px; overflow: hidden; width: 100%; }
                .stat-bar-fill { height: 100%; }
                
                @media print {
                    @page { margin: 1cm; }
                    body { background-color: #fff; padding: 0; }
                    .report-card { box-shadow: none; border: none; margin-bottom: 0; padding: 20px 0; height: 100vh; }
                }
            </style>
        </head>
        <body>
        `;

        sortedData.forEach((row) => {
            const analysis = calculateScores(row);
            let rawDesc = row[2] ? row[2].toString() : "";
            let partes = rawDesc.split("|||");
            let tel = "", hor = "", descReal = rawDesc;

            if (partes.length >= 3) {
                tel = partes[0]; hor = partes[1]; descReal = partes.slice(2).join("|||");
            } else if (partes.length === 2) {
                tel = partes[0]; descReal = partes[1];
            }

            const sortedScores = Object.entries(analysis.scores).sort((a,b) => b[1] - a[1]);
            const maxScore = sortedScores[0][1] || 1;
            let statsHtml = '';
            
            sortedScores.forEach(([area, val]) => {
                let perc = Math.min(100, Math.round((val / maxScore) * 100));
                let color = area === 'L√≠der' ? '#94a3b8' : '#1d366d';
                statsHtml += `
                    <div class="stat-item">
                        <div class="stat-label">
                            <span>${area}</span><span style="color: ${color};">${perc}%</span>
                        </div>
                        <div class="stat-bar-bg">
                            <div class="stat-bar-fill" style="background: ${color}; width: ${perc}%;"></div>
                        </div>
                    </div>
                `;
            });

            htmlContent += `
            <div class="report-card">
                <div class="report-header">Sistema de Aloca√ß√£o Estrat√©gica - UNINOVE</div>
                <h1 class="report-name">${row[1]}</h1>
                <div class="report-role">üéØ Melhor Afinidade Encontrada: ${analysis.main}</div>
                
                <div class="info-box">
                    <p><b>üì± Telefone:</b> ${tel || 'N√£o informado'}</p>
                    <p><b>üïí Chega quinta √†s:</b> ${hor || 'N√£o informado'}</p>
                    <p><b>‚è≥ Tempo Extra:</b> ${row[6]} hrs/semana</p>
                    <p><b>üìñ Resumo:</b> ${descReal || 'N√£o informado'}</p>
                </div>

                <div class="skills-container">
                    <div class="skill-badge">Info: ${row[3]}/10</div>
                    <div class="skill-badge">Prog: ${row[4]}/10</div>
                    <div class="skill-badge">Banco: ${row[5]}/10</div>
                </div>

                <div class="stats-title">An√°lise de Afinidade</div>
                ${statsHtml}
            </div>
            `;
        });

        htmlContent += `</body></html>`;
        return htmlContent;
    }

    function baixarHTML() {
        const htmlContent = exportarHTML();
        if(!htmlContent) return;
        const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Relatorio_Equipe_UNINOVE.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    function imprimirPDF() {
        const htmlContent = exportarHTML();
        if(!htmlContent) return;
        const printWindow = window.open('', '_blank');
        printWindow.document.write(htmlContent);
        printWindow.document.close();
        printWindow.focus();
        setTimeout(() => {
            printWindow.print();
        }, 500);
    }

    function closeModal() { document.getElementById('detailModal').style.display = 'none'; }
    function openCredits() { document.getElementById('creditsModal').style.display = 'block'; }
    function closeCredits() { document.getElementById('creditsModal').style.display = 'none'; }

    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let gameAnim;
    let player = { x: 210, y: 250, size: 35 };
    let items = [];
    let score = 0;
    let isPlaying = false;

    function getPointerPos(e) {
        const rect = canvas.getBoundingClientRect();
        let clientX = e.clientX;
        if (e.touches && e.touches.length > 0) clientX = e.touches[0].clientX;
        let scaleX = canvas.width / rect.width;
        let pos = (clientX - rect.left) * scaleX - player.size / 2;
        return Math.max(0, Math.min(pos, canvas.width - player.size));
    }

    canvas.addEventListener('mousemove', (e) => { if(isPlaying) player.x = getPointerPos(e); });
    canvas.addEventListener('touchmove', (e) => { 
        if(isPlaying) {
            player.x = getPointerPos(e);
            e.preventDefault();
        }
    }, {passive: false});

    function startGame() {
        if(isPlaying) return;
        isPlaying = true;
        score = 0;
        items = [];
        player.x = canvas.width / 2 - player.size / 2;
        document.getElementById('btn-start-game').style.display = 'none';
        updateGameStatus();
        gameLoop();
    }

    function spawnItem() {
        if(Math.random() < 0.02) {
            const types = ['‚òï', 'üí°', 'üêõ', 'üêõ'];
            const type = types[Math.floor(Math.random() * types.length)];
            items.push({
                x: Math.random() * (canvas.width - 30),
                y: -30,
                type: type,
                speed: 1 + Math.random() * 1.5
            });
        }
    }

    function gameLoop() {
        if(!isPlaying) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        ctx.font = "35px Arial";
        ctx.textAlign = "left";
        ctx.fillText("üë®‚Äçüíª", player.x, player.y + 30);

        for (let i = 0; i < items.length; i++) {
            let item = items[i];
            item.y += item.speed;
            
            ctx.font = "25px Arial";
            ctx.fillText(item.type, item.x, item.y + 25);

            if (item.y + 25 >= player.y && item.y <= player.y + 35 && item.x + 25 >= player.x && item.x <= player.x + 35) {
                if(item.type === 'üêõ') score = Math.max(0, score - 15);
                else if(item.type === '‚òï') score += 5;
                else if(item.type === 'üí°') score += 10;
                
                items.splice(i, 1);
                i--;
                updateGameStatus();
                continue;
            }

            if (item.y > canvas.height) {
                items.splice(i, 1);
                i--;
            }
        }
        
        spawnItem();

        if (score >= 100) {
            isPlaying = false;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#1d366d";
            ctx.font = "bold 26px Poppins";
            ctx.textAlign = "center";
            ctx.fillText("üéâ VOC√ä SE FORMOU! üéâ", canvas.width/2, canvas.height/2);
            document.getElementById('btn-start-game').innerText = "Jogar Novamente";
            document.getElementById('btn-start-game').style.display = 'inline-block';
            document.getElementById('game-status').innerText = "Diploma conquistado! O mercado te espera!";
            document.getElementById('game-progress').style.width = '100%';
            return;
        }

        gameAnim = requestAnimationFrame(gameLoop);
    }

    function updateGameStatus() {
        document.getElementById('game-progress').style.width = Math.min(score, 100) + '%';
        let status = "";
        if(score < 20) status = "1¬∫ Semestre: Aprendendo L√≥gica...";
        else if(score < 40) status = "3¬∫ Semestre: Estruturas de Dados.";
        else if(score < 60) status = "5¬∫ Semestre: Banco de Dados.";
        else if(score < 80) status = "7¬∫ Semestre: Foco no Projeto!";
        else status = "√öltimo Semestre: Desespero do TCC!";
        document.getElementById('game-status').innerText = status;
    }

    function openGame() {
        document.getElementById('gameModal').style.display = 'block';
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#94a3b8";
        ctx.font = "16px Poppins";
        ctx.textAlign = "center";
        ctx.fillText("Clique em Iniciar Jornada", canvas.width/2, canvas.height/2);
    }

    function closeGame() {
        document.getElementById('gameModal').style.display = 'none';
        isPlaying = false;
        cancelAnimationFrame(gameAnim);
        document.getElementById('btn-start-game').style.display = 'inline-block';
    }
</script>

</body>
</html>
